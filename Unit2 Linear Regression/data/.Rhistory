lines(data4[,4],col = color[4])
lines(data5[,4],col = color[5])
lines(data6[,4],col = color[6])
color <- rainbow(7)
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,5],col = color[2])
lines(data3[,5],col = color[3])
lines(data4[,5],col = color[4])
lines(data5[,5],col = color[5])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,5],col = color[2])
lines(data3[,5],col = color[3])
plot(data1[,4],type = 'l',col = color[1])
lines(data3[,5],col = color[3])
lines(data4[,5],col = color[4])
lines(data5[,5],col = color[5])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1])
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
mean(data1[,4])
mean(data3[,5])
mean(data4[,5])
mean(data6[,5])
plot(data1[,4],type = 'l',col = color[1])
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1],ylab='TVOCs',xlab = 'Time [min]' )
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1],ylab='Concentrations of TVOCs',xlab = 'Time [min]')
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
con <- Sys.glob("Desktop/TVOC DATA/*.csv")
data <- read.csv(con[1],header=FALSE)
data <- read.csv("Desktop/TVOC DATA/Room/1/2014.02.04-07此数据没怎么改但是很变态.csv")
head(data)
#
data <- read.csv("Desktop/TVOC DATA/Room/1/2014.02.04-07此数据没怎么改但是很变态.csv"
,header = F)
head(data)
10082/1440
data <- read.csv("Dropbox//TVOC DATA/Room/1/1.csv"
,header = F)
head(data)
plot.data <- plot(data[,c(2,4,6,7)])
plot.data <- c(data[,c(2,4,6,7)])
plot.data
plot.data <- c(data[,2],data[,4],data[,6],data[,8])
plot(plot.data)
plot(plot.data,type = 'l')
seq(100,1000,length=30)
seq(50,100,length=30)
abs(rnorm(48,mean = 1000, sd = 3000)
)
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
mean(data[,2])
sd(data[,2])
abs(rnorm(48,mean = 1500, sd = 1900))
rnorm(29,mean = 0, sd =2)
rnorm(29,mean = 0, sd = 3)
rnorm(29,mean = 0, sd = 2)
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2:8])
5760/48
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
newdata[1] <- data.vector[1]
for(i in 1:length(data.vector)){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[2:30] + rnorm(29, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
newdata[1] <- data.vector[1]
for(i in 1:length(data.vector)-1){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[2:30] + rnorm(29, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
newdata[1] <- data.vector[1]
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[2:30] + rnorm(29, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
length(newdata)
9716/1440
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[1:30] + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
10050/1440
30*48
1440*7
length(data.vector)
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
10080/1440
plot(newdata, type = 'l')
library(ggplot2)
data.plot <- data.frame(newdata)
ggplot(data.plot)
ggplot(data.plot) + geom_line()
data.plot <- data.frame(newdata)
ggplot(data.plot) + geom_line()
ggplot(data.plot,aes()) + geom_line()
ggplot(data.plot) + geom_line()
ggplot(data.plot,aes()) + geom_line()
?ggplot
ggplot(data=data.plot,aes()) + geom_line()
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30) + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
data.plot <- data.frame(newdata)
data.plot
length(data.plot)
nrow(data.plot)
head(data.plot)
ggplot(data.plot,aes(data.plot[,1])) + geom_line()
data.plot[,1]
ggplot(data.plot,aes(y = data.plot[,1])) + geom_line()
?ggplot
ggplot(data.plot, aes(y = data.plot[,1])) + geom_line()
plot(newdata, type = 'l')
library(ggplot2)
data.plot <- data.frame(newdata)
ggplot(data.plot, aes(y = data.plot[,1])) + geom_line()
newdata
data
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30) + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
ID <- 1:10080
library(ggplot2)
data.plot <- data.frame(ID,newdata)
ggplot(data.plot, aes(x=ID, y=newdata)) + geom_line()
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30) + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
ID <- 1:10080
write.csv(newdata, file = 'Desktop/result.csv')
?write.csv
data <- read.csv(file="Desktop/data/room2/room2-1.csv")
?read.csv
data <- read.csv("Desktop/data/room2/room2-1.csv")
head(data)
data <- read.csv("Desktop/data/room2/room2-1.csv")
getwd()
data <- read.csv("/Desktop/data/room2/room2-1.csv")
data <- read.csv("Desktop/data/room2/room2-1.csv")
data <- read.csv("Desktop/data/room2/room2-1.csv",header=FALSE)
data <- read.csv("Desktop/data/room2/room2-1.csv",header=FALSE,sep = ',')
data <- read.csv("Desktop/data/room2/room2-1.csv",header = FALSE)
data <- read.csv(file="Desktop/Room/1/room1-1.csv",header = FALSE)
head(data)
plot(data[,1],data[,2])
plot(data[,1],data[,2],type = "l")
?plot
plot(data[,1],data[,2],type = "l", pch = 20)
plot(data[,1],data[,2],type = "l", pch = 20, cex=0)
data <- read.csv(file="Desktop/Room/1/room1-1.csv",header = FALSE)
lines(data[,1],data[,2],type = "l", pch = 20, cex=0)
plot(data[,1],data[,2],type = "l", pch = 20, cex=0)
data <- read.csv(file="Desktop/Room/1/room1-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
max(data[,2])
min(data[,2])
data <- read.csv(file="Desktop/Room/1/room1-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/1/room1-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/1/room1-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/2/room2-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/1/1.csv",header = FALSE)
mean(data[,2:8])
median(data[,2:8])
min(data[,2:8])
max(data[,2:8])
data[,2:8]
data[,2:7]
data[,2:3]
head(data)
data <- read.csv(file="Desktop/Room/2/1.csv",header = FALSE)
mean(data[,2:8])
median(data[,2:8])
min(data[,2:8])
max(data[,2:8])
head(data)
data <- read.csv(file="Desktop/Room/2/1.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/2.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/3.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/4.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/4.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/5/room5-4.csv",header = FALSE)
max(data[,2])
setwd("Desktop/Analytics Edge/Unit2 Linear Regression/data/")
wine = read.csv("wine.csv")
model = lm(Price~HarvestRain+WinterRain,data=wine)
summary(model)
cor(wine$HarvestRain,wine$WinterRain)
baseball = read.csv("baseball.csv")
str(baseball)
moneyball = subset(baseball, Year < 2002)
str(moneyball)
moneyball$RD = moneyball$RS - moneyball$RA
str(moneyball)
plot(moneyball$RD, moneyball$W)
WinsReg = lm(W ~ RD, data=moneyball)
summary(WinsReg)
?predict
predict(WinsReg, RD = 99)
predict(WinsReg, 99)
predict(WinsReg, c(99))
predict(WinsReg)
Model1 = lm(RS ~ OBP + SLG, data=moneyball)
summary(Model1)
summary(moneyball)
Model2 = lm(RA ~ OOBP + OSLG, data=moneyball)
summary(Model2)
Player = data.frame(c(0.338,0.391,0.369,0.313,0.361),
c(0.540,0.450,0.347,0.447,0.500))
Player
predict(Model1,Player)
rownames(Player) = c("OBP","SLG")
names(Player) = c("OBP","SLG")
Player
predict(Model1,Player)
teamRank = c(1,2,2,3,3,4,4,4,4,5,5)
wins2012 = c(94,88,95,88,93,94,98,97,93,94)
wins2012 = c(94,88,95,88,93,94,98,97,93,94)
wins2013 = c(97,97,92,93,92,96,94,96,92,90)
cor(teamRank, wins2012)
cor(teamRank, wins2012)
?cor
teamRank = c(1,2,3,3,4,4,4,4,5,5)
cor(teamRank, wins2012)
cor(teamRank,wins2013)
NBA = read.csv("NBA_train.csv")
NBA = read.csv("NBA_train.csv")
str(NBA)
table(NBA$W, NBA$Playoffs)
NBA$PTSdiff = NBA$PTS - NBA$oppPTS
plot(NBA$PTSdiff, NBA$W)
WinsReg = lm(W ~ PTSdiff, data=NBA)
climate = read.csv("climate_change.csv")
str(climate)
climate_train = subset(climate, Year<=2006)
climate_test = subset(climate, Year>2006)
summary(climate_train)
summary(climate_test)
TempReg = lm(Temp ~ MEI + CO2 + CH4 + N2O + CFC.11 + CFC.12 + TSI + Aerosols, data = climate_train)
summary(TempReg)
cor(climate_train)
TempReg2 = lm(Temp ~ MEI + TSI + Aerosols + N2O, data=climate_train)
summary(TempReg2)
SSE = sum(TempReg$residuals^2)
RMSE = sqrt(SSE/nrow(climate_train))
SSE
RMSE
SSE_test = sum((predict(TempReg, newdata=climate_test) - climate_test$Temp)^2)
SSE_test
TempReg3 = step(TempReg)
summary(TempReg3)
SSE_test = sum((predict(TempReg3, newdata=climate_test) - climate_test$Temp)^2)
SST_test = sum((mean(climate_test$Temp) - climate_test$Temp)^2)
R_2 = 1 - SSE_test/SST_test
R_2
SSE_test = sum((predict(TempReg3, newdata=climate_test) - climate_test$Temp)^2)
SST_test = sum((mean(climate_train$Temp) - climate_test$Temp)^2)
R_2 = 1 - SSE_test/SST_test
R_2
clc
clc()
pisaTrain = read.csv("pisa2009train.csv")
pisaTest = read.csv("pisa2009test.csv")
str(pisaTrain)
tapply(pisaTrain$readingScore, pisaTrain$male, mean)
summary(pisaTrain)
pisaTrain = na.omit(pisaTrain)
pisaTest = na.omit(pisaTest)
str(pisaTrain)
str(pisaTest)
pisaTrain$raceeth = relevel(pisaTrain, "White")
pisaTest$raceeth = relevel(pisaTest$raceeth, "White")
pisaTrain$raceeth = relevel(pisaTrain$raceeth, "White")
str(pisaTest)
LinReg = lm(readingScore~, data=pisaTrain)
LinReg = lm(readingScore ~ ., data=pisaTrain)
summary(LinReg)
SSE = sum(LinReg$residuals^2)
RMSE = sqrt(SSE/nrow(LinReg))
RMSE
RMSE = sqrt(SSE/nrow(pisaTrain))
RMSE
predTest = predict(LinReg, newdata=pisaTest)
summary(predTest)
637.7-353.2
str(predTest)
SSE = sum((predTest-pisaTest$readingScore)^2)
SSE
RMSE = sqrt(SSE/nrow(pisaTest))
RMSE
baseline = mean(pisaTrain$readingScore)
baseline
SST = sum((predTest - baseline)^2)
SST
SST = sum((baseline-pisaTest$readingScore)^2)
SST
R = 1 - SSE/SST
R
FluTrain = read.csv("FluTrain.csv")
summary(FluTrain)
table(FluTrain$Week, FluTrain$ILI)
str(FluTrain)
which(FluTrain$ILI == max(FluTrain$ILT))
which(FluTrain$ILI == max(FluTrain$ILI))
FluTrain[303,]
which(FluTrain$ILI == max(FluTrain$Queries))
which(FluTrain$ILI == max(FluTrain$Queries))
which(FluTrain$Queries == max(FluTrain$Queries))
hist(FluTrain$ILI)
plot(FluTrain$Queries, log(FluTrain$ILI))
LinReg = lm(log(ILT) ~ Queries, data = FluTrain)
LinReg = lm(log(ILI) ~ Queries, data = FluTrain)
summary(LinReg)
cor(FluTrain)
cor(FluTrain$Queries, log(FluTrain$ILI))
cor(FluTrain$Queries, log(FluTrain$ILI))^2
FluTest = read.csv("FluTest.csv")
FluTrend1 = lm(log(ILI) ~ Queries, data = FluTrain)
PredTest1 = predict(FluTrend1, newdata=FluTest)
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
str(PredTest1)
str(FluTest)
which(FluTest$Week = "2012-03-11")
which(FluTest$Week == "2012-03-11")
FluTest
which(FluTest$Week == "012-03-11 - 2012-03-17")
which(FluTest$Week == "2012-03-11 - 2012-03-17")
index = which(FluTest$Week == "2012-03-11 - 2012-03-17")
PredTest1[index]
(2.2934216-2.187378)/2.2934216
SSE = sum((PredTest1 - FluTest$ILI)^2)
RMSE = sqrt(SSE/nrow(FluTest))
RMSE
install.packages("zoo")
library(zoo)
ILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)
ILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)
FluTrain$ILILag2 = coredata(ILILag2)
ILILag2
FluTrain
str(FluTrain)
summary(FluTrain)
library(ggplot2)
?ggplot
plot(log(FluTrain$ILILag2), log(FluTrain$ILI))
FluTrend2 = lm(log(ILI) ~ log(ILILag2) + Queries, data=FluTrain)
summary(FluTrend2)
summary(FluTrend1)
ILILag2_test = lag(zoo(FluTest$ILI), -2, na.pad=TRUE)
FluTest$ILILag2 = coredata(ILILag2_test)
str(FluTest)
nrow(FluTest)
nrow(FluTrain)
FluTest$ILILag2[1:2] = FluTrain$ILILag2[416:417]
str(FluTest)
FluTest$ILILag2[1:2] = FluTrain$ILI[416:417]
str(FluTest)
PreTest2 = predict(FluTrend2, newdata=FluTest)
PreTest2 = exp(predict(FluTrend2, newdata=FluTest))
SSE = sum((PreTest2 - FluTest$ILI))
RMSE = sqrt(SSE/nrow(FluTest))
RMSE
PreTest2 = exp(predict(FluTrend2, newdata=FluTest))
SSE = sum((PreTest2 - FluTest$ILI)^2)
RMSE = sqrt(SSE/nrow(FluTest))
RMSE
