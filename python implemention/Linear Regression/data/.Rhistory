# time4
time4 <- data[1081:1440,]
random4 <- floor(runif(360, -10, 10))
time4[,4] <- time4[,4] + random4
# day
day1 <- rbind(time1,time2,time3,time4)
day2 <- rbind(time1,time3,time2,time4)
day3 <- rbind(time4,time3,time2,time1)
newdata <- rbind(data, day1[96:1440,],day1,day2)
nrow(newdata)
plot(newdata[,4],type='l')
con <- Sys.glob("Desktop/TVOC DATA/*.csv")
data <- read.csv(con[1],header=FALSE)
nrow(data)
getwd()
con <- Sys.glob("Desktop/TVOC DATA/编完的/*.csv")
con
data1 <- read.csv(con[1],header=FALSE)
length(con)
data1 <- read.csv(con[1],header=FALSE)
data2 <- read.csv(con[2],header=FALSE)
data3 <- read.csv(con[3],header=FALSE)
data4 <- read.csv(con[4],header=FALSE)
data5 <- read.csv(con[5],header=FALSE)
data6 <- read.csv(con[6],header=FALSE)
color <- rainbow(7)
plot(data1[,4],type = 'l',col = color[1])
plot(data1[,4],type = 'l',col = color[1])
line(data2[,4],color = col = color[2])
line(data3[,4],color = col = color[3])
line(data4[,4],color = col = color[4])
line(data5[,4],color = col = color[5])
line(data6[,4],color = col = color[6])
plot(data1[,4],type = 'l',col = color[1])
line(data2[,4],col = color[2])
line(data3[,4],col = color[3])
line(data4[,4],col = color[4])
line(data5[,4],col = color[5])
line(data6[,4],col = color[6])
plot(data1[,4],type = 'l',col = color[1])
line(data2[,4],col = color[2])
color <- rainbow(7)
color
line(data2[,4],color = color[2])
color <- rainbow(7)
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,4],col = color[2])
lines(data3[,4],col = color[3])
lines(data4[,4],col = color[4])
lines(data5[,4],col = color[5])
lines(data6[,4],col = color[6])
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,4],col = color[2])
lines(data3[,4],col = color[3])
lines(data4[,4],col = color[4])
lines(data5[,4],col = color[5])
lines(data6[,4],col = color[6])
head(data2)
data2 <- read.csv(con[2])
head(data2)
data1 <- read.csv(con[1],header=FALSE)
data2 <- read.csv(con[2])
data3 <- read.csv(con[3])
data4 <- read.csv(con[4])
data5 <- read.csv(con[5])
data6 <- read.csv(con[6])
color <- rainbow(7)
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,4],col = color[2])
lines(data3[,4],col = color[3])
lines(data4[,4],col = color[4])
lines(data5[,4],col = color[5])
lines(data6[,4],col = color[6])
color <- rainbow(7)
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,5],col = color[2])
lines(data3[,5],col = color[3])
lines(data4[,5],col = color[4])
lines(data5[,5],col = color[5])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1])
lines(data2[,5],col = color[2])
lines(data3[,5],col = color[3])
plot(data1[,4],type = 'l',col = color[1])
lines(data3[,5],col = color[3])
lines(data4[,5],col = color[4])
lines(data5[,5],col = color[5])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1])
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
mean(data1[,4])
mean(data3[,5])
mean(data4[,5])
mean(data6[,5])
plot(data1[,4],type = 'l',col = color[1])
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1],ylab='TVOCs',xlab = 'Time [min]' )
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
plot(data1[,4],type = 'l',col = color[1],ylab='Concentrations of TVOCs',xlab = 'Time [min]')
lines(data3[,5],col = color[2])
lines(data4[,5],col = color[3])
lines(data6[,5],col = color[6])
con <- Sys.glob("Desktop/TVOC DATA/*.csv")
data <- read.csv(con[1],header=FALSE)
data <- read.csv("Desktop/TVOC DATA/Room/1/2014.02.04-07此数据没怎么改但是很变态.csv")
head(data)
#
data <- read.csv("Desktop/TVOC DATA/Room/1/2014.02.04-07此数据没怎么改但是很变态.csv"
,header = F)
head(data)
10082/1440
data <- read.csv("Dropbox//TVOC DATA/Room/1/1.csv"
,header = F)
head(data)
plot.data <- plot(data[,c(2,4,6,7)])
plot.data <- c(data[,c(2,4,6,7)])
plot.data
plot.data <- c(data[,2],data[,4],data[,6],data[,8])
plot(plot.data)
plot(plot.data,type = 'l')
seq(100,1000,length=30)
seq(50,100,length=30)
abs(rnorm(48,mean = 1000, sd = 3000)
)
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
mean(data[,2])
sd(data[,2])
abs(rnorm(48,mean = 1500, sd = 1900))
rnorm(29,mean = 0, sd =2)
rnorm(29,mean = 0, sd = 3)
rnorm(29,mean = 0, sd = 2)
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2:8])
5760/48
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
newdata[1] <- data.vector[1]
for(i in 1:length(data.vector)){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[2:30] + rnorm(29, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
newdata[1] <- data.vector[1]
for(i in 1:length(data.vector)-1){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[2:30] + rnorm(29, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
rnorm(29,mean = 0, sd = 2)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
newdata[1] <- data.vector[1]
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[2:30] + rnorm(29, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
length(newdata)
9716/1440
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30)[1:30] + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
10050/1440
30*48
1440*7
length(data.vector)
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
10080/1440
plot(newdata, type = 'l')
library(ggplot2)
data.plot <- data.frame(newdata)
ggplot(data.plot)
ggplot(data.plot) + geom_line()
data.plot <- data.frame(newdata)
ggplot(data.plot) + geom_line()
ggplot(data.plot,aes()) + geom_line()
ggplot(data.plot) + geom_line()
ggplot(data.plot,aes()) + geom_line()
?ggplot
ggplot(data=data.plot,aes()) + geom_line()
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30) + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
data.plot <- data.frame(newdata)
data.plot
length(data.plot)
nrow(data.plot)
head(data.plot)
ggplot(data.plot,aes(data.plot[,1])) + geom_line()
data.plot[,1]
ggplot(data.plot,aes(y = data.plot[,1])) + geom_line()
?ggplot
ggplot(data.plot, aes(y = data.plot[,1])) + geom_line()
plot(newdata, type = 'l')
library(ggplot2)
data.plot <- data.frame(newdata)
ggplot(data.plot, aes(y = data.plot[,1])) + geom_line()
newdata
data
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30) + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
ID <- 1:10080
library(ggplot2)
data.plot <- data.frame(ID,newdata)
ggplot(data.plot, aes(x=ID, y=newdata)) + geom_line()
data <- read.csv("Dropbox//TVOC DATA/Room/1/2.csv"
,header = F)
data.vector <- c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8])
newdata <- vector()
for(i in 1:(length(data.vector)-1)){
add <- seq(data.vector[i],data.vector[i+1],length = 30) + rnorm(30, mean = 0, sd = 2)
newdata <- c(newdata, add)
}
last <- seq(data.vector[335],data.vector[336],length = 30)
newdata <- c(newdata, last)
ID <- 1:10080
write.csv(newdata, file = 'Desktop/result.csv')
?write.csv
data <- read.csv(file="Desktop/data/room2/room2-1.csv")
?read.csv
data <- read.csv("Desktop/data/room2/room2-1.csv")
head(data)
data <- read.csv("Desktop/data/room2/room2-1.csv")
getwd()
data <- read.csv("/Desktop/data/room2/room2-1.csv")
data <- read.csv("Desktop/data/room2/room2-1.csv")
data <- read.csv("Desktop/data/room2/room2-1.csv",header=FALSE)
data <- read.csv("Desktop/data/room2/room2-1.csv",header=FALSE,sep = ',')
data <- read.csv("Desktop/data/room2/room2-1.csv",header = FALSE)
data <- read.csv(file="Desktop/Room/1/room1-1.csv",header = FALSE)
head(data)
plot(data[,1],data[,2])
plot(data[,1],data[,2],type = "l")
?plot
plot(data[,1],data[,2],type = "l", pch = 20)
plot(data[,1],data[,2],type = "l", pch = 20, cex=0)
data <- read.csv(file="Desktop/Room/1/room1-1.csv",header = FALSE)
lines(data[,1],data[,2],type = "l", pch = 20, cex=0)
plot(data[,1],data[,2],type = "l", pch = 20, cex=0)
data <- read.csv(file="Desktop/Room/1/room1-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
max(data[,2])
min(data[,2])
data <- read.csv(file="Desktop/Room/1/room1-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/1/room1-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/1/room1-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/2/room2-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/3/room3-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/4/room4-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-1.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-2.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-3.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/5/room5-4.csv",header = FALSE)
mean(data[,2])
median(data[,2])
min(data[,2])
max(data[,2])
data <- read.csv(file="Desktop/Room/1/1.csv",header = FALSE)
mean(data[,2:8])
median(data[,2:8])
min(data[,2:8])
max(data[,2:8])
data[,2:8]
data[,2:7]
data[,2:3]
head(data)
data <- read.csv(file="Desktop/Room/2/1.csv",header = FALSE)
mean(data[,2:8])
median(data[,2:8])
min(data[,2:8])
max(data[,2:8])
head(data)
data <- read.csv(file="Desktop/Room/2/1.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/2.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/3.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/4.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/2/4.csv",header = FALSE)
mean(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
median(c(data[,2],data[,3],data[,4],data[,5],data[,6],data[,7],data[,8]))
min(data[,2:8])
max(data[,2:8])
data <- read.csv(file="Desktop/Room/5/room5-4.csv",header = FALSE)
max(data[,2])
data(state)
statedata = cbind(data.frame(state.x77), state.abb, state.area,
state.center, state.division, state.name, state.region)
str(statedata)
plot(statedata$x, statedata$y)
plot(statedata$y, statedata$x)
plot(statedata$x, statedata$y)
plot(statedata$x, statedata$y,lty=1)
?type
?plot
plot(statedata$x, statedata$y,cex = 1)
plot(statedata$x, statedata$y,cex = 2)
plot(statedata$x, statedata$y,cex = 0.1)
plot(statedata$x, statedata$y,cex = 0.5)
tapply(statedata$HS.Grad, statedata$state.region, mean)
boxplot(statedata$Murder, statedata$state.region)
boxplot(statedata$state.region, statedata$Murder)
?boxplot
boxplot(statedata$Murder ~ statedata$state.region)
northest = subset(statedata, state.region = "Northeast")
northeast = subset(statedata, state.region = "Northeast")
northeast
northeast = subset(statedata, state.region == "Northeast")
northeast
str(statedata)
stateNew = statedata[,1:8]
str(stateNew)
life.expReg = lm(Life.Exp ~ ., data=stateNew)
summary(life.expReg)
plot(statedata$Income, statedata$Life.Exp)
life.expReg2 = lm(Life.Exp ~ Population + Income + Illiteracy + Murder + HS.Grad + Frost,
data = statedata)
summary(life.expReg2)
life.expReg3 = lm(Life.Exp ~ Population + Income + Murder + HS.Grad + Frost,
data = statedata)
summary(life.expReg3)
life.expReg4 = lm(Life.Exp ~ Population + Murder + HS.Grad + Frost, data = statedata)
summary(life.expReg4)
cor(stateNew)
life.expReg2 = lm(Life.Exp ~ Population + Income + Illiteracy + Murder + HS.Grad + Frost + Area,
data = statedata)
summary(life.expReg2)
life.expReg2 = lm(Life.Exp ~ Population + Income + Illiteracy + Murder + HS.Grad + Frost,
data = statedata)
life.expReg3 = lm(Life.Exp ~ Population + Income + Murder + HS.Grad + Frost,
data = statedata)
life.expReg2 = lm(Life.Exp ~ Population + Income + Illiteracy + Murder + HS.Grad + Frost,
data = statedata)
life.expReg3 = lm(Life.Exp ~ Population + Income + Murder + HS.Grad + Frost,
data = statedata)
life.expReg4 = lm(Life.Exp ~ Population + Murder + HS.Grad + Frost, data = statedata)
summary(life.expReg4)
summary(life.expReg2)
life.expReg5 = step(life.expReg)
summary(life.expReg)
summary(life.expReg4)
sort(predict(life.expReg4))
sort(table(statedata$Life.Exp))
predict(life.expReg4)
str(statedata)
sort(table(statedata$state.name, statedata$Life.Exp))
?sort
which(statedata$Life.Exp == min(statedata$Life.Exp))
statedata[40,]
which.max(statedata$Life.Exp)
statedata[11,]
life.expReg4$residuals
sort(life.expReg4$residuals)
getwd()
setwd("Desktop/Analytics Edge/Unit2 Linear Regression/data/")
data = read.csv("elantra.csv")
str(data)
train = subset(data, Year <= 2012)
test = subset(data, Year > 2012)
summary(train)
summary(test)
str(train)
salesReg = lm(ElantraSales ~ Unemployment + Queries + CPI_energy + CPI_all, data = train)
summary(salesReg)
salesReg2 = lm(ElantraSales ~ Unemployment + Queries + CPI_energy + CPI_all + Month, data = train)
summary(salesReg2)
train$Month_factor = as.factor(train$Month)
str(train$Month)
str(train)
salesReg3 = lm(ElantraSales ~ Unemployment + Queries + CPI_energy + CPI_all + Month_factor,
data = train)
summary(salesReg3)
cor(train)
cor(train)
cor(train[,-1])
cor(train[,-1])
cor(train[,:-1])
cor(ElantraTrain[c("Unemployment","Month","Queries","CPI_energy","CPI_all")])
cor(train[c("Unemployment","Month","Queries","CPI_energy","CPI_all")])
salesReg4 = lm(ElantraSales ~ Unemployment + CPI_energy + CPI_all + Month_factor,
data = train)
summary(salesReg4)
test$Month_factor = as.factor(test$Month)
salesPred = predict(salesReg4, newdata=test)
SSE = sum((salesPred - test$ElantraSales)^2)
SSE
baseline = mean(train$ElantraSales)
baseline
SST = sum((salesPred - baseline)^2)
1 - SSE/SST
SST = sum((test$ElantraSales - baseline)^2)
1 - SSE/SST
max(abs(salesPred))
max(abs(salesPred - test$ElantraSales))
which.max(abs(salesPred - test$ElantraSales))
which.max(abs(salesPred - test$ElantraSales))
salesPred
test[5,]
